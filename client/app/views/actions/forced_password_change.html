<div class="row">
  <div class="col-md-12" data-translate>Before proceeding, please set a new password.</div>
</div>
<div class="row mt-3">
  <div class="col-md-4">
    <form name="resources.preferences.orm" novalidate>
      <div class="form-group">
        <label>
          <span data-translate>New password</span>
          <span class="text-danger" data-uib-tooltip="{{'This field is mandatory' | translate}}">*</span>
        </label>
        <input class="form-control" name="password" data-ng-model="resources.preferences.password" type="password" autocomplete="off" data-ng-class="{'is-invalid': passwordChangeForm.password.$error.required || passwordChangeForm.password.$error.passwordStrengthValidator}" data-password-strength-validator required />
        <password-meter data-ng-show="passwordStrengthScore" value="passwordStrengthScore"></password-meter>
        <div class="text-danger" data-ng-show="passwordStrengthScore && passwordStrengthScore < 2">
          <p data-translate>The chosen password is too weak. A valid password should be at least 10 characters long and contain a variety of characters including at least a lowercase character, a capital character, a number and a special character.</p>
         </div>
        <div class="text-danger" data-ng-show="resources.preferences.password && resources.preferences.password === resources.preferences.old_password">
          <p data-translate>The new password must be different from the current one.</p>
        </div>
      </div>

      <div class="form-group">
        <label>
          <span data-translate>Type your new password again</span>
          <span class="text-danger" data-uib-tooltip="{{'This field is mandatory' | translate}}">*</span>
        </label>
        <input class="form-control" name="checkpassword" data-ng-model="resources.preferences.check_password" type="password" autocomplete="off" data-ng-class="{'is-invalid': resources.preferences.password.length && !passwordChangeForm.password.$error && (passwordChangeForm.checkpassword.$error.required || resources.preferences.password !== resources.preferences.check_password)}" required/>
        <p class="text-danger" data-ng-show="resources.preferences.password.length && !passwordChangeForm.password.$error.passwordStrengthValidator && (resources.preferences.password !== resources.preferences.check_password)">
          <span data-translate>The two passwords do not match</span>
        </p>
      </div>

      <div class="alert alert-danger" data-ng-show="errors[0].code === 11">
        <span data-translate>The new password must differ from the previous.</span>
      </div>

      <button type="submit" class="mt-3 btn btn-primary" data-ng-disabled="passwordChangeForm.$invalid || passwordChangeForm.$pristine || resources.preferences.password !== resources.preferences.check_password || (resources.preferences.password && resources.preferences.password === resources.preferences.old_password)" data-ng-click="save()">
        <span data-translate>Proceed</span>
        <i class="fas fa-arrow-circle-right"></i>
      </button>
    </form>
  </div>
</div>
